<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>HW // WLM 2023 - HW11 // Логистическая регрессия. Пуассоновская регрессия</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./hw12.html" rel="next">
<link href="./hw10.html" rel="prev">
<link href="./pics/favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Ничего не найдено",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Очистить",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Отмена",
    "search-submit-button-title": "Отправить",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./pics/logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">WLM 2023 // HSE UX LAB</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./../hub/index.html"> 
<span class="menu-text">Хаб</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./../lectures/index.html"> 
<span class="menu-text">Лекции</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./../practice/index.html"> 
<span class="menu-text">Практики</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./../homeworks/index.html"> 
<span class="menu-text">Домашки</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./../projects/index.html"> 
<span class="menu-text">Проекты</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./hw11.html">HW11 // Логистическая регрессия. Пуассоновская регрессия</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Вступление</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hw1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW1 // Введение в R. Типы данных. Векторы</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hw2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW2 // Матрицы и списки. Функции</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hw3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW3 // Датафреймы. Исследование данных</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hw4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW4 // Предобработка данных</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hw5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW5 // Визуализация данных</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hw6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW6 // Случайный эксперимент. Случайные величины</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hw7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW7 // Оценивание параметров в практике статистического анализа. Тестирование статистических гипотез</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hw8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW8 // Описательные статистики. Корреляционный анализ</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hw9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW9 // Простая линейная регрессия. Множественная линейная регрессия</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hw10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW10 // Дисперсионный анализ. Ковариационный анализ</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hw11.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">HW11 // Логистическая регрессия. Пуассоновская регрессия</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hw12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW12 // Обобщенные аддитивные модели. Регуляризованная регрессия</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hw13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW13 // Смешанные линейные модели</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hw14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW14 // Кластерный анализ</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hw15.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW15 // Анализ главных компонент. Эксплораторный факторный анализ</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hw16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW16 // Конфирматорный факторный анализ</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Источники</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Содержание</h2>
   
  <ul>
  <li><a href="#hw11_main" id="toc-hw11_main" class="nav-link active" data-scroll-target="#hw11_main">Основные задания</a>
  <ul class="collapse">
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section">#1</a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1">#2</a></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2">#3</a></li>
  <li><a href="#section-3" id="toc-section-3" class="nav-link" data-scroll-target="#section-3">#4</a></li>
  <li><a href="#section-4" id="toc-section-4" class="nav-link" data-scroll-target="#section-4">#5</a></li>
  <li><a href="#section-5" id="toc-section-5" class="nav-link" data-scroll-target="#section-5">#6</a></li>
  <li><a href="#section-6" id="toc-section-6" class="nav-link" data-scroll-target="#section-6">#7</a></li>
  <li><a href="#section-7" id="toc-section-7" class="nav-link" data-scroll-target="#section-7">#8</a></li>
  <li><a href="#section-8" id="toc-section-8" class="nav-link" data-scroll-target="#section-8">#9</a></li>
  <li><a href="#hw11-10-title" id="toc-hw11-10-title" class="nav-link" data-scroll-target="#hw11-10-title">#10</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="hw11" class="quarto-section-identifier">HW11 // Логистическая регрессия. Пуассоновская регрессия</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!--
REPLACE ALL hw11 TO hw<n> WITH MATCH CASE
-->
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Данные
</div>
</div>
<div class="callout-body-container callout-body">
<p>Сегодня мы работаем с данными о факторам сердечно-сосудистых заболеваний. Ниже представлено описание данных из <a href="https://www.kaggle.com/dileep070/heart-disease-prediction-using-logistic-regression">источника</a>.</p>
<p><strong>Introduction</strong> World Health Organization has estimated 12 million deaths occur worldwide, every year due to Heart diseases. Half the deaths in the United States and other developed countries are due to cardio vascular diseases. The early prognosis of cardiovascular diseases can aid in making decisions on lifestyle changes in high risk patients and in turn reduce the complications. This research intends to pinpoint the most relevant/risk factors of heart disease as well as predict the overall risk using logistic regression Data Preparation</p>
<p><strong>Source</strong> The dataset is publically available on the Kaggle website, and it is from an ongoing cardiovascular study on residents of the town of Framingham, Massachusetts. The classification goal is to predict whether the patient has 10-year risk of future coronary heart disease (CHD).The dataset provides the patients’ information. It includes over 4,000 records and 15 attributes.</p>
<p><strong>Variables</strong> Each attribute is a potential risk factor. There are both demographic, behavioral and medical risk factors.</p>
<ul>
<li>Demographic:
<ul>
<li><code>male</code>: male or female (Nominal)</li>
<li><code>age</code>: Age of the patient; (Continuous - Although the recorded ages have been truncated to whole numbers, the concept of age is continuous)</li>
</ul></li>
<li>Behavioral:
<ul>
<li><code>currentSmoker</code>: whether or not the patient is a current smoker (Nominal)</li>
<li><code>cigsPerDay</code>: the number of cigarettes that the person smoked on average in one day (can be considered continuous as one can have any number of cigarettes, even half a cigarette.)</li>
</ul></li>
<li>Medical (history):
<ul>
<li><code>BPMeds</code>: whether or not the patient was on blood pressure medication (Nominal)</li>
<li><code>prevalentStroke</code>: whether or not the patient had previously had a stroke (Nominal)</li>
<li><code>prevalentHyp</code>: whether or not the patient was hypertensive (Nominal)</li>
<li><code>diabetes</code>: whether or not the patient had diabetes (Nominal)</li>
</ul></li>
<li>Medical (current):
<ul>
<li><code>totChol</code>: total cholesterol level (Continuous)</li>
<li><code>sysBP</code>: systolic blood pressure (Continuous)</li>
<li><code>diaBP</code>: diastolic blood pressure (Continuous)</li>
<li><code>BMI</code>: Body Mass Index (Continuous)</li>
<li><code>heartRate</code>: heart rate (Continuous — In medical research, variables such as heart rate though in fact discrete, yet are considered continuous because of large number of possible values.)</li>
<li><code>glucose</code>: glucose level (Continuous)</li>
</ul></li>
<li>Predict variable (desired target):
<ul>
<li><code>TenYearCHD</code>: 10 year risk of coronary heart disease CHD (binary: “1”, means “Yes”, “0” means “No”)</li>
</ul></li>
</ul>
<p>Необходимо выяснить, какие факторы влияют на риск сердечнососудистых заболеваний в перспективе 10 лет. Переменную <code>TenYearCHD</code> мы будем рассматривать как целевую, все остальные — в качестве предикторов.</p>
</div>
</div>
<section id="hw11_main" class="level2">
<h2 class="anchored" data-anchor-id="hw11_main">Основные задания</h2>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section">#1</h3>
<p><img id="hw11-1-level" class="level"></p>
<div id="hw11-1-task" class="task">
<ol type="a">
<li>Загрузите <a href="https://raw.githubusercontent.com/angelgardt/wlm2023/master/data/hw11/framingham.csv">датасет</a> в переменую <code>heart</code>. Изучите их структуру.</li>
<li>Предобработайте данные, если это необходимо: удалите пропущенные значения, скорректируйте типы переменных. Перезапишите датасет.</li>
</ol>
</div>
<div id="hw11-1-autocheck" class="autocheck">
<div id="hw11-1-ir" class="input-requirements">
<p>В качестве ответа для самопроверки введите количество строк в датасете, полученном после удаления пропущенных значений.</p>
</div>
<p><input class="autocheck-input" type="text" id="hw11-1" placeholder="Введите ответ…"></p>
<p><input class="autocheck-button" type="button" value="Проверить" onclick="check('hw11-1')"></p>
<div id="hw11-1-fb" class="autocheck-feedback">

</div>
</div>
<div class="hints-wrapper">
<details class="hints" id="hw11-1-hints">
<summary>
Подсказка
</summary>
<p>Удалить все пропущенные значения можно с помощью функции <code>drop_na()</code>.</p>
</details>
</div>
</section>
<section id="section-1" class="level3">
<h3 class="anchored" data-anchor-id="section-1">#2</h3>
<p><img id="hw11-2-level" class="level"></p>
<div id="hw11-2-task" class="task">
<p>Сегодня мы поработаем с изученной моделью в более «машиннообученском». подходе. Начнем в разбиения выборки на обучающую (тренировочную) и тестовую.</p>
<p>Разбейте данные на обучающую и тестовую выборки в соотношении 7/3 — 70% данных должно оказать в обучающей и 30% в тестовой. Сохраните обучающий датасет в переменную <code>heart_train</code>, а тестовый — в <code>heart_test</code>.</p>
<p>Для воспроизводимых результатов используйте <code>set.seed(616)</code>.</p>
</div>
<div id="hw11-2-autocheck" class="autocheck">
<div id="hw11-2-ir" class="input-requirements">
<p>В качестве ответа для самопроверки введите среднее по переменной <code>TenYearCHD</code> обучающей выборки. В качестве десятичного разделителя используйте точку.</p>
</div>
<p><input class="autocheck-input" type="text" id="hw11-2" placeholder="Введите ответ…"></p>
<p><input class="autocheck-button" type="button" value="Проверить" onclick="check('hw11-2')"></p>
<div id="hw11-2-fb" class="autocheck-feedback">

</div>
</div>
<div class="hints-wrapper">
<details class="hints" id="hw11-2-hints">
<summary>
Подсказки
</summary>
<p>Чтобы разбить датасет на тренировочную и тестовую части, необходимо:</p>
<ul>
<li>сгенерировать вектор случайных индексов из номеров строк общего датасета длиной, равной 70% от числа строк датасета</li>
<li>с помощью индексации (или функции из <code>tidyverse</code>) вытащить строки со сгенерированными номерами и сохранить результат в <code>heart_train</code></li>
<li>с помощью «отрицательной» индексации (или функции из <code>tidyverse</code>) вытащить строки со всеми номерами, кроме сгенерированных, и сохранить результат в <code>heart_test</code></li>
</ul>
</details>
</div>
</section>
<section id="section-2" class="level3">
<h3 class="anchored" data-anchor-id="section-2">#3</h3>
<p><img id="hw11-3-level" class="level"></p>
<div id="hw11-3-task" class="task">
<ol type="a">
<li>Постройте модель на обучающей выборке. Целевой переменной выступит <code>TenYearCHD</code>, все остальные — в качестве предикторов. Так как в модели достаточно много предикторов, взаимодействия мы включать не будем.</li>
<li>Протестируйте общую статистическую значимость модели с помощью теста отношения правдоподобий. Проинтерпретируйте результаты.</li>
</ol>
</div>
<div id="hw11-3-autocheck" class="autocheck">
<div id="hw11-3-ir" class="input-requirements">
<p>В качестве ответа для самопроверки введите значение девиансы построенной модели (<code>deviance</code>), округленное до целого.</p>
</div>
<p><input class="autocheck-input" type="text" id="hw11-3" placeholder="Введите ответ…"></p>
<p><input class="autocheck-button" type="button" value="Проверить" onclick="check('hw11-3')"></p>
<div id="hw11-3-fb" class="autocheck-feedback">

</div>
</div>
<div class="hints-wrapper">
<details class="hints" id="hw11-3-hints">
<summary>
Подсказки
</summary>
<p>Чтобы проестировать гипотезу об общей статистической значимости модели, необходимо:</p>
<ul>
<li>построить нулевую модель, аналогичную заданной, но только с одним предиктором — интерсептом</li>
<li>провести тест отношения правдоподобий с помощью функции <code>anova()</code>, указав в аргументе <code>test</code> необходимый тест</li>
<li>значение аргумента <code>test</code> соответствует распределению, которому подчиняется распределение значения отношения правдоподобий</li>
</ul>
</details>
</div>
</section>
<section id="section-3" class="level3">
<h3 class="anchored" data-anchor-id="section-3">#4</h3>
<p><img id="hw11-4-level" class="level"></p>
<div id="hw11-4-task" class="task">
<ol type="a">
<li>Используя тесты отношения превдоподобий, упростите модель, исключив незначимые предикторы.</li>
<li>Сравните с помощью статистического теста и информационных критериев исходную и упрощенную модели.</li>
<li>Выберите, с какой в дальнейшем вы будете работать:
<ul>
<li>если модели различаются, то мы, исключив предикторы, потеряли что-то важное, значит необходимо работать с полной моделью</li>
<li>если модели не различаются, то мы, исключив предикторы, <strong>не</strong> потеряли ничего важного, значит проще работать с сокращенной моделью</li>
</ul></li>
</ol>
</div>
<div id="hw11-4-autocheck" class="autocheck">
<div id="hw11-4-ir" class="input-requirements">
<p>В качестве ответа для самопроверки введите значение девиансы сокращенной модели (<code>deviance</code>), округленное до целого.</p>
</div>
<p><input class="autocheck-input" type="text" id="hw11-4" placeholder="Введите ответ…"></p>
<p><input class="autocheck-button" type="button" value="Проверить" onclick="check('hw11-4')"></p>
<div id="hw11-4-fb" class="autocheck-feedback">

</div>
</div>
<div class="hints-wrapper" hidden="true">
<details class="hints" id="hw11-4-hints">
<summary>
Подсказки
</summary>
<details class="hint">
<summary>
Как делать задание?
</summary>
</details>
<details class="hint">
<summary>
Что надо сделать?
</summary>
</details>
<details class="hint">
<summary>
Ответ неверный
</summary>
</details>
</details>
</div>
</section>
<section id="section-4" class="level3">
<h3 class="anchored" data-anchor-id="section-4">#5</h3>
<p><img id="hw11-5-level" class="level"></p>
<div id="hw11-5-task" class="task">
<ol type="a">
<li>Постройте confusion matrix по тренировочным данным для выбранной в предыдущем задании модели.
<ul>
<li>Так как мы работаем с медицинскими данными, воспользуемся достаточно либеральным порогом для получения категориальных предсказаний в 0.6. Идея исходит из подхода гипердиагностики — лучше взять и обследовать пациента с меньшим риском, чтобы выявить потенциально опасные патологии на раннем этапе.</li>
</ul></li>
<li>Рассчитайте метрики предказательной силы модели — accuracy, precision, recall, F1-меру — по построенной confusion matrix.</li>
<li>Дайте оценку качеству модели по полученным значениям.</li>
</ol>
</div>
<div id="hw11-5-autocheck" class="autocheck">
<div id="hw11-5-ir" class="input-requirements">
<p>Для самопроверки в поле ниже введите значение F1-меры, округленное <em>до тысячных</em>. В качестве десятичного разделителя используйте точку.</p>
</div>
<p><input class="autocheck-input" type="text" id="hw11-5" placeholder="Введите ответ…"></p>
<p><input class="autocheck-button" type="button" value="Проверить" onclick="check('hw11-5')"></p>
<div id="hw11-5-fb" class="autocheck-feedback">

</div>
</div>
<div class="hints-wrapper">
<details class="hints" id="hw11-5-hints">
<summary>
Подсказки
</summary>
<p>Confusion matrix имеет следующую структуру:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">Предсказания: <span class="math inline">\(0\)</span></th>
<th style="text-align: center;">Предсказания: <span class="math inline">\(1\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Данные: <span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\text{TN}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\text{FP}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Данные: <span class="math inline">\(1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\text{FN}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\text{TP}\)</span></td>
</tr>
</tbody>
</table>
<ul>
<li><em>True Positive</em> (<span class="math inline">\(\text{TP}\)</span>) — верное предсказанные единицы</li>
<li><em>True Negative</em> (<span class="math inline">\(\text{TN}\)</span>) — верно предсказанные нули</li>
<li><em>False Positive</em> (<span class="math inline">\(\text{FP}\)</span>) — ложноположительные предсказания, ошибочно предсказанные единицы</li>
<li><em>False Negative</em> ($ — ложноотрицательные предсказания, ошибочно предсказанные нули</li>
</ul>
<p>Формулы для расчета метрик таковы:</p>
<p><span class="math display">\[
\begin{split}
&amp; \text{accuracy} = \frac{\text{TP} + \text{TN}}{\text{TP} + \text{TN} + \text{FP} + \text{FN}} \\
&amp; \text{precision} = \frac{\text{TP}}{\text{TP} + \text{FP}} \\
&amp; \text{recall} = \frac{\text{TP}}{\text{TP} + \text{FN}} \\
&amp; \text{F1} = 2 \cdot \frac{\text{precision} \cdot \text{recall}}{\text{precision} + \text{recall}}
\end{split}
\]</span></p>
</details>
</div>
</section>
<section id="section-5" class="level3">
<h3 class="anchored" data-anchor-id="section-5">#6</h3>
<p><img id="hw11-6-level" class="level"></p>
<div id="hw11-6-task" class="task">
<ol type="a">
<li>Возьмите несколько более строгих значений порогов — 0.7, 0.8 и 0.9 — и посмотрите, справляется ли модель с предсказаниями лучше, если использовать их.</li>
<li>Выберите, при каком пороге модель наиболее хорошо описывает данные. Сравнивая модели, неободимо посмотреть на все метрики, однако для принятия окончательного решения можно воспользоваться F1-мерой, как обобщенным показателем precision и recall.</li>
</ol>
<p><strong>Возможно, проще будет сначала сделать <a href="#hw11-10-title">задание 10</a>. Это сократит код.</strong></p>
</div>
<div id="hw11-6-autocheck" class="autocheck">
<div id="hw11-6-ir" class="input-requirements">
<p>Для самопроверки в поле ответа введите порог, при котором получаются наилучшие предсказания. В качестве десятичного разделителя используйте точку.</p>
</div>
<p><input class="autocheck-input" type="text" id="hw11-6" placeholder="Введите ответ…"></p>
<p><input class="autocheck-button" type="button" value="Проверить" onclick="check('hw11-6')"></p>
<div id="hw11-6-fb" class="autocheck-feedback">

</div>
</div>
<div class="hints-wrapper" hidden="true">
<details class="hints" id="hw11-6-hints">
<summary>
Подсказки
</summary>
<details class="hint">
<summary>
Как делать задание?
</summary>
</details>
<details class="hint">
<summary>
Что надо сделать?
</summary>
</details>
<details class="hint">
<summary>
Ответ неверный
</summary>
</details>
</details>
</div>
</section>
<section id="section-6" class="level3">
<h3 class="anchored" data-anchor-id="section-6">#7</h3>
<p><img id="hw11-7-level" class="level"></p>
<div id="hw11-7-task" class="task">
<p>С помощью имеющейся модели и выбранного порога получите предсказания для тестовых данных.</p>
</div>
<div id="hw11-7-autocheck" class="autocheck">
<div id="hw11-7-ir" class="input-requirements">
<p>Для самопроверки в поле ответа введите среднее по вектору предсказаний, округленное <em>до тысячных</em>. В качестве десятичного разделителя используйте точку.</p>
</div>
<p><input class="autocheck-input" type="text" id="hw11-7" placeholder="Введите ответ…"></p>
<p><input class="autocheck-button" type="button" value="Проверить" onclick="check('hw11-7')"></p>
<div id="hw11-7-fb" class="autocheck-feedback">

</div>
</div>
<div class="hints-wrapper">
<details class="hints" id="hw11-7-hints">
<summary>
Подсказки
</summary>
<ul>
<li>Чтобы получить предсказания для тестовых данных, воспользуйтесь функцией <code>predict()</code>, в которую необходимо передать модель и новые данные, а также указать в аргументе <code>type</code> значение <code>"response"</code>, чтобы получить предсказания вероятностей.</li>
<li>Далее, используя выбранный порог, получите дискретные предсказания модели.</li>
</ul>
</details>
</div>
</section>
<section id="section-7" class="level3">
<h3 class="anchored" data-anchor-id="section-7">#8</h3>
<p><img id="hw11-8-level" class="level"></p>
<div id="hw11-8-task" class="task">
<ol type="a">
<li>Постройте confusion matrix для предсказаний на тестовой выборке и рассчитайте метрики предсказательной силы.</li>
<li>Сопоставьте результаты с метриками, полученными на тренировочных данных.</li>
</ol>
</div>
<div id="hw11-8-autocheck" class="autocheck">
<div id="hw11-8-ir" class="input-requirements">
<p>Для самопроверки в поле ниже введите значение F1-меры, округленное <em>до тысячных</em>. В качестве десятичного разделителя используйте точку.</p>
</div>
<p><input class="autocheck-input" type="text" id="hw11-8" placeholder="Введите ответ…"></p>
<p><input class="autocheck-button" type="button" value="Проверить" onclick="check('hw11-8')"></p>
<div id="hw11-8-fb" class="autocheck-feedback">

</div>
</div>
<div class="hints-wrapper">
<details class="hints" id="hw11-8-hints">
<summary>
Подсказки
</summary>
<ul>
<li>При сопоставлении метрик необходимо понять, выше или ниже они получились на тестовой выборке по сравнению с обучающей (тренировочной).
<ul>
<li>Если они ниже, то проблем с переобучением модели не возникло — можно пытаться экстраполировать результаты на генеральную совокупность.</li>
<li>Если они выше, то результаты моделирования зависят больше от данных, чем от самой модели — есть трудности с обобщением результатов на генеральную сопокупность.</li>
</ul></li>
</ul>
</details>
</div>
</section>
<section id="section-8" class="level3">
<h3 class="anchored" data-anchor-id="section-8">#9</h3>
<p><img id="hw11-9-level" class="level"></p>
<div id="hw11-9-task" class="task">
<p>Проверьте основные допущения рассматриваемой модели — линейность связи между предикторами и целевой переменной и отсутствие сверхдисперсии. Проинтерпретируйте полученные результаты.</p>
<p>Для проверки линейности достаточно графической диагностики, для проверси сверхдисперсии используйте функцию ниже (она же использовалась на практике):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html#testing-for-overdispersioncomputing-overdispersion-factor</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>overdisp_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(model) {</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  rdf <span class="ot">&lt;-</span> <span class="fu">df.residual</span>(model)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">inherits</span>(model, <span class="st">'negbin'</span>))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    rdf <span class="ot">&lt;-</span> rdf <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  rp <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model, <span class="at">type =</span> <span class="st">'pearson'</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  Pearson.chisq <span class="ot">&lt;-</span> <span class="fu">sum</span>(rp <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  prat <span class="ot">&lt;-</span> Pearson.chisq <span class="sc">/</span> rdf</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  pval <span class="ot">&lt;-</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pchisq</span>(Pearson.chisq, <span class="at">df =</span> rdf, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">chisq =</span> Pearson.chisq,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">ratio =</span> prat,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">rdf =</span> rdf,</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">p =</span> pval</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Копировать" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="hw11-9-autocheck" class="autocheck">
<div id="hw11-9-ir" class="input-requirements">
<p>Для самопроверки в поле ниже введите значение <code>ratio</code>, полученное при проверке допущения об отсутствии сверхдисперсии, округленное <em>до тысячных</em>. В качестве десятичного разделителя используйте точку.</p>
</div>
<p><input class="autocheck-input" type="text" id="hw11-9" placeholder="Введите ответ…"></p>
<p><input class="autocheck-button" type="button" value="Проверить" onclick="check('hw11-9')"></p>
<div id="hw11-9-fb" class="autocheck-feedback">

</div>
</div>
<div class="hints-wrapper">
<details class="hints" id="hw11-9-hints">
<summary>
Подсказки
</summary>
<ul>
<li>Для проверки линейности связи необходимо построить график зависимости пирсоновских остатков от предсказанных моделью значений.
<ul>
<li>Предсказания получаются из модели с помощью функции <code>predict()</code> с указанием <code>type = "response"</code> без использования новых данных, так как нас интересуют значения предсказания для данных, на которых модель была подобрана.</li>
<li>Остатки получаются аналогично с помощью функции <code>resid()</code> с указанием <code>type = "pearson"</code>, чтобы получить стандартизированные значения остатков.</li>
<li>Для отображения тренда используется <code>geom_smooth()</code> с методом <code>"loess"</code>, так как линейный тренд здесь не работает из-за использования функции связи внутри модели.</li>
</ul></li>
<li>При проверке сверхдисперсии нулевая гипотеза теста гласит, что в данных не наблюдается сверхдисперсии, а альтернативная — что сверхдисперсия присутствует. Соответствующим образом интерпретируется и результат тестирования.</li>
</ul>
</details>
</div>
</section>
<section id="hw11-10-title" class="level3">
<h3 class="anchored" data-anchor-id="hw11-10-title">#10</h3>
<p><img id="hw11-10-level" class="level"></p>
<div id="hw11-10-task" class="task">
<p>На практике упоминалось, что расчет метрик предсказательной силы модели можно обернуть в функцию, чтобы не таскать много строк кода каждый раз, когда необходимо проверить качество модели. Давайте это сделаем.</p>
<p>Напишите функцию <code>prediction_metrics()</code>, которая будет рассчитывать метрики предсказательной силы модели на основе значений целевой переменной из данных и предсказанных вероятностей. Функция должна:</p>
<ul>
<li>принимать на вход:
<ul>
<li>вектор значений бинарной переменной из данных (<code>data</code>)</li>
<li>вектор предсказанных моделью вероятностей (<code>response</code>)</li>
<li>порог, использующийся для перевода непрерывных предсказаний в дискретные (<code>threshold</code>)</li>
</ul></li>
<li>возвращать:
<ul>
<li>именованный вектор со значениями <code>accuracy</code>, <code>precision</code>, <code>recall</code> и <code>F1-меры</code>.</li>
</ul></li>
</ul>
<p>Пример работы функции на полной модели представлен ниже.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prediction_metrics</span>(<span class="at">data =</span> heart_train<span class="sc">$</span>TenYearCHD,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">response =</span> <span class="fu">predict</span>(model1, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">threshold =</span> <span class="fl">0.6</span>)</span></code><button title="Копировать" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  accuracy  precision     recall         F1 
0.84946646 0.92857143 0.03194103 0.06175772 </code></pre>
</div>
</div>
<div id="hw11-10-autocheck" class="autocheck" hidden="true">
<div id="hw11-10-ir" class="input-requirements">
<p>Описание формата инпута.</p>
</div>
<p><input class="autocheck-input" type="text" id="hw11-10" placeholder="Введите ответ…"></p>
<p><input class="autocheck-button" type="button" value="Проверить" onclick="check('hw11-10')"></p>
<div id="hw11-10-fb" class="autocheck-feedback">

</div>
</div>
<div class="hints-wrapper">
<details class="hints" id="hw11-10-hints">
<summary>
Подсказки
</summary>
<ul>
<li>Чтобы написать функцию, необходимо взять код, используемый для расчета метрика предсказательной силы модели и заменить используемые в нем переменные на соответствующие аргументы функции.</li>
<li>Чтобы создать именованный вектор, нужно задать соответствие между именем элемента вектора и его значением: <code>c(name1 = value1, name2 = value2, ...)</code>.</li>
</ul>
</details>
</div>
<!---
## Дополнительные задания {#hw11_add}

### #1

<img id="hw11-11-level" class="level"/>

::: {#hw11-11-task .task}
Текст задания.
:::

::: {#hw11-11-autocheck .autocheck}
::: {#hw11-11-ir .input-requirements}
Описание формата инпута.
:::

<input class="autocheck-input" type="text" id="hw11-11" placeholder="Введите ответ…">

<input class="autocheck-button" type="button" value="Проверить" onclick="check('hw11-11')">

::: {#hw11-11-fb .autocheck-feedback}
:::
:::

::: hints-wrapper
<details class="hints" id="hw11-11-hints">

<summary>Подсказки</summary>

<details class="hint">

<summary>Как делать задание?</summary>

</details>

<details class="hint">

<summary>Что надо сделать?</summary>

</details>

<details class="hint">

<summary>Ответ неверный</summary>

</details>

</details>
:::

### #2

<img id="hw11-12-level" class="level"/>

::: {#hw11-12-task .task}
Текст задания.
:::

::: {#hw11-12-autocheck .autocheck}
::: {#hw11-12-ir .input-requirements}
Описание формата инпута.
:::

<input class="autocheck-input" type="text" id="hw11-12" placeholder="Введите ответ…">

<input class="autocheck-button" type="button" value="Проверить" onclick="check('hw11-12')">

::: {#hw11-12-fb .autocheck-feedback}
:::
:::

::: hints-wrapper
<details class="hints" id="hw11-12-hints">

<summary>Подсказки</summary>

<details class="hint">

<summary>Как делать задание?</summary>

</details>

<details class="hint">

<summary>Что надо сделать?</summary>

</details>

<details class="hint">

<summary>Ответ неверный</summary>

</details>

</details>
:::

### #3

<img id="hw11-13-level" class="level"/>

::: {#hw11-13-task .task}
Текст задания.
:::

::: {#hw11-13-autocheck .autocheck}
::: {#hw11-13-ir .input-requirements}
Описание формата инпута.
:::

<input class="autocheck-input" type="text" id="hw11-13" placeholder="Введите ответ…">

<input class="autocheck-button" type="button" value="Проверить" onclick="check('hw11-13')">

::: {#hw11-13-fb .autocheck-feedback}
:::
:::

::: hints-wrapper
<details class="hints" id="hw11-13-hints">

<summary>Подсказки</summary>

<details class="hint">

<summary>Как делать задание?</summary>

</details>

<details class="hint">

<summary>Что надо сделать?</summary>

</details>

<details class="hint">

<summary>Ответ неверный</summary>

</details>

</details>
:::

### #4

<img id="hw11-14-level" class="level"/>

::: {#hw11-14-task .task}
Текст задания.
:::

::: {#hw11-14-autocheck .autocheck}
::: {#hw11-14-ir .input-requirements}
Описание формата инпута.
:::

<input class="autocheck-input" type="text" id="hw11-14" placeholder="Введите ответ…">

<input class="autocheck-button" type="button" value="Проверить" onclick="check('hw11-14')">

::: {#hw11-14-fb .autocheck-feedback}
:::
:::

::: hints-wrapper
<details class="hints" id="hw11-14-hints">

<summary>Подсказки</summary>

<details class="hint">

<summary>Как делать задание?</summary>

</details>

<details class="hint">

<summary>Что надо сделать?</summary>

</details>

<details class="hint">

<summary>Ответ неверный</summary>

</details>

</details>
:::

### #5

<img id="hw11-15-level" class="level"/>

::: {#hw11-15-task .task}
Текст задания.
:::

::: {#hw11-15-autocheck .autocheck}
::: {#hw11-15-ir .input-requirements}
Описание формата инпута.
:::

<input class="autocheck-input" type="text" id="hw11-15" placeholder="Введите ответ…">

<input class="autocheck-button" type="button" value="Проверить" onclick="check('hw11-15')">

::: {#hw11-15-fb .autocheck-feedback}
:::
:::

::: hints-wrapper
<details class="hints" id="hw11-15-hints">

<summary>Подсказки</summary>

<details class="hint">

<summary>Как делать задание?</summary>

</details>

<details class="hint">

<summary>Что надо сделать?</summary>

</details>

<details class="hint">

<summary>Ответ неверный</summary>

</details>

</details>
:::

--->
<!--- CHANGE hw11 TO hw<n> IN THE LINES BELOW--->
<script type="text/javascript" src="./js/hw11.json"></script>
<script type="text/javascript" src="./js/hw.js"></script>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Скопировано!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Скопировано!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./hw10.html" class="pagination-link  aria-label=" hw10="" дисперсионный="" анализ.="" ковариационный="" анализ"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">HW10 // Дисперсионный анализ. Ковариационный анализ</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./hw12.html" class="pagination-link" aria-label="HW12 // Обобщенные аддитивные модели. Регуляризованная регрессия">
        <span class="nav-page-text">HW12 // Обобщенные аддитивные модели. Регуляризованная регрессия</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>